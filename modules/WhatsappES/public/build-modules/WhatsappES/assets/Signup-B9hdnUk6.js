import{T as h,c as r,u as i,a as o,t as c,b as g,v as w,o as d}from"./app-BL7UDPsO.js";import"https://connect.facebook.net/en_US/sdk.js";const v={class:"card mx-auto max-w-2xl p-10 text-center"},y={key:0,class:"flex items-center justify-center gap-4"},k={key:1},x=["disabled"],D={__name:"Signup",props:["facebook_client_id","whatsapp_es_config_id"],setup(p){const _={danger:n=>alert(n)},l=p,e=h({name:null,phone_number_id:null,waba_id:null,business_id:null,auth_code:null});window.fbAsyncInit=function(){FB.init({appId:l.facebook_client_id,autoLogAppEvents:!0,xfbml:!0,version:"v23.0"})},window.addEventListener("message",n=>{var s,a,u;if(n.origin.endsWith("facebook.com"))try{const t=JSON.parse(n.data);t.type==="WA_EMBEDDED_SIGNUP"&&t.event==="FINISH"&&(e.phone_number_id=((s=t.data)==null?void 0:s.phone_number_id)||null,e.waba_id=((a=t.data)==null?void 0:a.waba_id)||null,e.business_id=((u=t.data)==null?void 0:u.business_id)||null)}catch{}});const m=n=>{if(n.authResponse){const s=n.authResponse.code;e.auth_code=s,e.phone_number_id&&e.waba_id&&e.business_id?f():console.error("Missing phone_number_id, waba_id or business_id")}},b=()=>{if(!e.name){_.danger("Please enter a device name first.");return}FB.login(m,{config_id:l.whatsapp_es_config_id,response_type:"code",override_default_response_type:!0,extras:{sessionInfoVersion:"3"}})},f=()=>{e.post(route("user.whatsapp.platforms.store"))};return(n,s)=>(d(),r("div",v,[i(e).processing?(d(),r("div",y,[o("h5",null,c(n.trans("Processing your request... Please wait")),1),s[1]||(s[1]=o("div",{class:"spinner"},"Loading...",-1))])):(d(),r("div",k,[g(o("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>i(e).name=a),placeholder:"Enter Device Name",required:"",class:"input w-full mb-2"},null,512),[[w,i(e).name]]),o("button",{class:"btn btn-primary mx-auto mt-2 w-full",onClick:b,disabled:!i(e).name},c(n.trans("Continue with facebook login")),9,x)]))]))}};export{D as default};
